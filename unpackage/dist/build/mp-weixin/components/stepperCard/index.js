(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/stepperCard/index"],{"32e4":function(t,e,r){"use strict";r.r(e);var n=r("70ca"),a=r("d8da");for(var o in a)"default"!==o&&function(t){r.d(e,t,(function(){return a[t]}))}(o);r("7a5a");var i,s=r("f0c5"),c=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"e33424b6",null,!1,n["a"],i);e["default"]=c.exports},"70ca":function(t,e,r){"use strict";var n,a=function(){var t=this,e=t.$createElement,r=(t._self._c,t.setDecimalFun(t.SalePrice));t.$mp.data=Object.assign({},{$root:{m0:r}})},o=[];r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return o})),r.d(e,"a",(function(){return n}))},"7a5a":function(t,e,r){"use strict";var n=r("7b16"),a=r.n(n);a.a},"7b16":function(t,e,r){},a9d3:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r("3955"));function a(t){return t&&t.__esModule?t:{default:t}}var o=function(){r.e("components_uni/uni-popup/uni-popup").then(function(){return resolve(r("117d"))}.bind(null,r)).catch(r.oe)},i=function(){r.e("components/stepper-my/index").then(function(){return resolve(r("f898"))}.bind(null,r)).catch(r.oe)},s=r("bf5e"),c=getApp(),u=function(){r.e("components_uni/uni-goods-nav/uni-goods-nav").then(function(){return resolve(r("15cf"))}.bind(null,r)).catch(r.oe)},l=function(){r.e("components_uni/uni-number-box/uni-number-box").then(function(){return resolve(r("ce96"))}.bind(null,r)).catch(r.oe)},h={components:{uniPopup:o,stepper:i,uniGoodsNav:u,uniNumberBox:l},props:{itemData:{type:Object,value:{}},isShowCode:{type:Boolean,value:!1},isCollage:{type:Boolean,value:!1},controlBuy:{type:Boolean,value:!0},isCollageInfo:{type:Boolean,value:!1}},data:function(){return{colorNum:c.globalData.colorIndex,itemColor:c.globalData.itemColor,SalePrice:"",showPopup:!1,recordParts:[],recordFlavor:[],listData:{flavor:{titleNorms:"口味",normsArr:[]},parts:{titleNorms:"配件",normsArr:[]},specs:{titleNorms:"规格",normsArr:[]}},currentSpecs:0,currentSpecsObj:{},surplusStock:0,buttonGroup:[{text:"单独购买",backgroundColor:"#fe8953",color:"#fff"},{text:"我要开团",backgroundColor:"#ff4343",color:"#fff"}],originalPrice:!1,userInfo_empower:{}}},mounted:function(){var t=Number(this.itemData.EveryOneMaxBuyCount)-(this.itemData.hasOwnProperty("ActiveOwnBuyCount")&&this.itemData.ActiveOwnBuyCount>0?Number(this.itemData.ActiveOwnBuyCount):0);this.surplusStock=this.itemData.hasOwnProperty("EveryOneMaxBuyCount")&&this.itemData.EveryOneMaxBuyCount>0?t:this.itemData.hasOwnProperty("ActiveSaleCount")&&this.itemData.ActiveSaleCount>0?Number(this.itemData.StockQty)-Number(this.itemData.ActiveSaleCount):Number(this.itemData.StockQty),this.newItemData.num=1},computed:{newItemData:function(){return this.itemData}},methods:{setDecimalFun:function(t){return s.setDecimal(t)},stepperChange:function(t){var e=0,r=[];this.recordParts.forEach((function(t){e+=Number(t.SalePrice),r.push(t.ProdNo)})),r=r.join(",");for(var n={},a=[],o=0;o<this.recordFlavor.length;o++){var i=this.recordFlavor[o];a.push(i.TastName)}var c=JSON.parse(JSON.stringify(this.newItemData));c.recordFlavor=a,c.num=!t||t instanceof Object?c.num:t,n.itemData=c,n.itemData.prodType=1,n.recordParts=this.recordParts,n.itemData.prodPartsInfo=this.recordParts,n.itemData.ProdParts=r,n.itemData.ActiveSalePrice&&(n.itemData.SalePrice=n.itemData.ActiveSalePrice);for(o=0;o<this.recordParts.length;o++)this.recordParts[o].num=c.num;"{}"!=JSON.stringify(this.currentSpecsObj)?(n.itemData.ProdName=this.currentSpecsObj.CombName,n.itemData.StockQty=this.currentSpecsObj.StockQty,n.itemData.CombNo=this.currentSpecsObj.CombNo,n.itemData.SalePrice=Number(this.currentSpecsObj.CombPrice)+e):n.itemData.SalePrice=Number(n.itemData.SalePrice)+e;var u=s.setStock(n);u?(this.showPopup=!1,this.$emit("mycurrentPage",n,this.originalPrice,this.userInfo_empower),this.currentIndexParts=null,this.currentIndexFlavor=null,this.currentSpecs=null,this.recordFlavor=[],this.recordParts=[],this.currentSpecsObj={}):this.disabled=!0},onChangeNum:function(t){this.newItemData.num=t},clickTag:function(){var t=this;n.default.api("ProdPartsOrTast.aspx",{ProdNo:this.newItemData.ProdNo,ActiveID:this.originalPrice?"":this.newItemData.ActiveID||""}).then((function(e){var r=e.ProdPartsInfo,n=e.ProdTastInfo,a=e.ProdCombInfo;if(t.listData.parts.normsArr=r,t.listData.flavor.normsArr=n,t.listData.specs.normsArr=a,t.listData.specs.normsArr.splice(),n.forEach((function(t,e){t.id=e})),r.forEach((function(t,e){t.prodType=2})),r.length>0||n.length>0||a.length>0){t.showPopup=!0;for(var o=0;o<n.length;o++)n[o].isActive=!1;for(o=0;o<r.length;o++)r[o].isActive=!1,r[o].num=0;a.length>0&&(t.currentSpecs=a[0].CombNo,t.currentSpecsObj=a[0],t.SalePrice=a[0].CombPrice),t.listData=t.listData}else t.isCollage||(t.$emit("setShowStepper",!0),t.newItemData.showStepper=!0,t.stepperChange())})).catch((function(t){console.log(t,"error")}))},onClose:function(t){if(!t.show){this.showPopup=!1;var e=this;setTimeout((function(){e.currentIndexParts=null,e.currentIndexFlavor=null,e.recordFlavor=[],e.recordParts=[],e.currentSpecs=null,e.currentSpecsObj={},e.SalePrice=""}),300)}},tapCurrentLiSpecs:function(t){this.currentSpecs=t;var e=this.listData.specs.normsArr.filter((function(e){return e.CombNo===t}));this.currentSpecsObj=e[0],this.SalePrice=this.currentSpecsObj.CombPrice},tapCurrentLiFlavor:function(t){p(this,"flavor","recordFlavor",t)},tapCurrentLi:function(t){p(this,"parts","recordParts",t)},stepperNumChange:function(t){this.stepperChange(t)},clickTagEmpty:function(){t.showToast({title:"该商品已售罄",icon:"none"})},buttonClick:function(e){if(0===e.index)this.originalPrice=!0,this.clickTag();else{if(!this.controlBuy)return void t.showToast({title:"无法开团",icon:"none"});this.originalPrice=!1,this.clickTag()}},bindgetuserinfo:function(e){if(this.originalPrice)this.stepperChange();else if("getUserInfo:ok"===e.detail.errMsg){var r=JSON.parse(e.detail.rawData);this.userInfo_empower={NickName:r.nickName,HeardImg:r.avatarUrl},this.stepperChange()}else t.showToast({title:"未授权无法购买哦！",duration:2e3,icon:"none"})}},watch:{"newItemData.SalePrice":function(t){this.SalePrice=this.newItemData.SalePrice},isShowCode:function(t){t&&this.clickTag()}}};function p(t,e,r,n){var a=t.listData[e].normsArr[n],o=t[r],i="";if(i="parts"===e?"ProdNo":"id",a.isActive=!a.isActive,t.listData=t.listData,a.isActive)o.push(a);else if(o.length>0)for(var s=0;s<o.length;s++){var c=o[s];a[i]===c[i]&&o.splice(s,1)}function u(t){var e=null;return"parts"===t?(e="ProdNo",function(t,r){var n=t[e],a=r[e];return n-a}):(e="TastName",function(t,r){return t[e].localeCompare(r[e],"zh-CN")})}o=o.sort(u(e)),t.currentIndexFlavor=n,t[r]=o}e.default=h}).call(this,r("543d")["default"])},d8da:function(t,e,r){"use strict";r.r(e);var n=r("a9d3"),a=r.n(n);for(var o in n)"default"!==o&&function(t){r.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/stepperCard/index-create-component',
    {
        'components/stepperCard/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("32e4"))
        })
    },
    [['components/stepperCard/index-create-component']]
]);
