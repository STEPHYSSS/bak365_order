(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/stepperCard/index"],{"09be":function(t,e,r){"use strict";var n=r("8996"),o=r.n(n);o.a},"32e4":function(t,e,r){"use strict";r.r(e);var n=r("ad5a"),o=r("d8da");for(var a in o)"default"!==a&&function(t){r.d(e,t,(function(){return o[t]}))}(a);r("09be");var i,s=r("f0c5"),c=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"1a94721f",null,!1,n["a"],i);e["default"]=c.exports},8996:function(t,e,r){},a9d3:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(r("3955"));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(){r.e("components_uni/uni-popup/uni-popup").then(function(){return resolve(r("117d"))}.bind(null,r)).catch(r.oe)},i=function(){r.e("components/stepper-my/index").then(function(){return resolve(r("f898"))}.bind(null,r)).catch(r.oe)},s=r("bf5e"),c=getApp(),u=function(){r.e("components_uni/uni-goods-nav/uni-goods-nav").then(function(){return resolve(r("15cf"))}.bind(null,r)).catch(r.oe)},l=function(){r.e("components_uni/uni-number-box/uni-number-box").then(function(){return resolve(r("ce96"))}.bind(null,r)).catch(r.oe)},h={components:{uniPopup:a,stepper:i,uniGoodsNav:u,uniNumberBox:l},props:{itemData:{type:Object,value:{}},isShowCode:{type:Boolean,value:!1},isCollage:{type:Boolean,value:!1},controlBuy:{type:Boolean,value:!0},isCollageInfo:{type:Boolean,value:!1},disabledAll:{type:Boolean,value:!1}},data:function(){return{colorNum:c.globalData.colorIndex,itemColor:c.globalData.itemColor,SalePrice:"",showPopup:!1,recordParts:[],recordFlavor:[],listData:{flavor:{titleNorms:"口味",normsArr:[]},parts:{titleNorms:"配件",normsArr:[]},specs:{titleNorms:"规格",normsArr:[]}},currentSpecs:0,currentSpecsObj:{},surplusStock:0,buttonGroup:[{text:"单独购买",backgroundColor:"#fe8953",color:"#fff"},{text:"我要开团",backgroundColor:"#ff4343",color:"#fff"}],originalPrice:!1,userInfo_empower:{},disabled:!1}},mounted:function(){var t=Number(this.itemData.EveryOneMaxBuyCount)-(this.itemData.hasOwnProperty("ActiveOwnBuyCount")&&this.itemData.ActiveOwnBuyCount>0?Number(this.itemData.ActiveOwnBuyCount):0);this.surplusStock=this.itemData.hasOwnProperty("EveryOneMaxBuyCount")&&this.itemData.EveryOneMaxBuyCount>0?t:this.itemData.hasOwnProperty("ActiveSaleCount")&&this.itemData.ActiveSaleCount>0?Number(this.itemData.StockQty)-Number(this.itemData.ActiveSaleCount):Number(this.itemData.StockQty),this.newItemData.num=1},computed:{newItemData:function(){return this.itemData}},methods:{setDecimalFun:function(t){return s.setDecimal(t)},stepperChange:function(t){var e=0,r=[];this.recordParts.forEach((function(t){e+=Number(t.SalePrice),r.push(t.ProdNo)})),r=r.join(",");for(var n={},o=[],a=0;a<this.recordFlavor.length;a++){var i=this.recordFlavor[a];o.push(i.TastName)}var c=JSON.parse(JSON.stringify(this.newItemData));c.recordFlavor=o,c.num=t instanceof Object?c.num:t,n.itemData=c,n.itemData.prodType=1,n.recordParts=this.recordParts,n.itemData.prodPartsInfo=this.recordParts,n.itemData.ProdParts=r,n.itemData.ActiveSalePrice&&(n.itemData.SalePrice=n.itemData.ActiveSalePrice);for(a=0;a<this.recordParts.length;a++)this.recordParts[a].num=c.num;"{}"!=JSON.stringify(this.currentSpecsObj)?(n.itemData.ProdName=this.currentSpecsObj.CombName,n.itemData.StockQty=this.currentSpecsObj.StockQty,n.itemData.CombNo=this.currentSpecsObj.CombNo,n.itemData.SalePrice=Number(this.currentSpecsObj.CombPrice)+e):n.itemData.SalePrice=Number(n.itemData.SalePrice)+e;var u=s.setStock(n);u?(this.showPopup=!1,this.$emit("mycurrentPage",n,this.originalPrice,this.userInfo_empower),this.currentIndexParts=null,this.currentIndexFlavor=null,this.currentSpecs=null,this.recordFlavor=[],this.recordParts=[],this.currentSpecsObj={}):this.disabled=!0},onChangeNum:function(t){this.newItemData.num=t},clickTag:function(){var t=this;n.default.api("ProdPartsOrTast.aspx",{ProdNo:this.newItemData.ProdNo,ActiveID:this.originalPrice?"":this.newItemData.ActiveID||""}).then((function(e){var r=e.ProdPartsInfo,n=e.ProdTastInfo,o=e.ProdCombInfo;if(t.listData.parts.normsArr=r,t.listData.flavor.normsArr=n,t.listData.specs.normsArr=o,t.listData.specs.normsArr.splice(),n.forEach((function(t,e){t.id=e})),r.forEach((function(t,e){t.prodType=2})),r.length>0||n.length>0||o.length>0){t.showPopup=!0;for(var a=0;a<n.length;a++)n[a].isActive=!1;for(a=0;a<r.length;a++)r[a].isActive=!1,r[a].num=0;o.length>0&&(t.currentSpecs=o[0].CombNo,t.currentSpecsObj=o[0],t.SalePrice=o[0].CombPrice),t.listData=t.listData}else t.isCollage||(t.$emit("setShowStepper",!0),t.newItemData.showStepper=!0,t.stepperChange())})).catch((function(t){console.log(t,"error")}))},onClose:function(t){if(!t.show){this.showPopup=!1;var e=this;setTimeout((function(){e.currentIndexParts=null,e.currentIndexFlavor=null,e.recordFlavor=[],e.recordParts=[],e.currentSpecs=null,e.currentSpecsObj={},e.SalePrice=""}),300)}},tapCurrentLiSpecs:function(t){console.log(t,"zhe"),this.currentSpecs=t;var e=this.listData.specs.normsArr.filter((function(e){return e.CombNo===t}));this.currentSpecsObj=e[0],this.SalePrice=this.currentSpecsObj.CombPrice},tapCurrentLiFlavor:function(t){p(this,"flavor","recordFlavor",t)},tapCurrentLi:function(t){p(this,"parts","recordParts",t)},stepperNumChange:function(t){this.stepperChange(t)},clickTagEmpty:function(){t.showToast({title:"该商品已售罄",icon:"none"})},buttonClick:function(e){if(0===e.index)this.originalPrice=!0,this.clickTag();else{if(!this.controlBuy)return void t.showToast({title:"无法开团",icon:"none"});this.originalPrice=!1,this.clickTag()}},bindgetuserinfo:function(e){if(this.originalPrice)this.stepperChange();else if("getUserInfo:ok"===e.detail.errMsg){var r=JSON.parse(e.detail.rawData);this.userInfo_empower={NickName:r.nickName,HeardImg:r.avatarUrl},this.stepperChange()}else t.showToast({title:"未授权无法购买哦！",duration:2e3,icon:"none"})}},watch:{"newItemData.SalePrice":function(t){this.SalePrice=this.newItemData.SalePrice},"newItemData.showStepper":function(t){this.newItemData.num=t?1:0},showPopup:function(t){this.newItemData.num=t?1:0},isShowCode:function(t){t&&this.clickTag()},itemData:{handler:function(t){console.log(t)},deep:!0}}};function p(t,e,r,n){var o=t.listData[e].normsArr[n],a=t[r],i="";if(i="parts"===e?"ProdNo":"id",o.isActive=!o.isActive,t.listData=t.listData,o.isActive)a.push(o);else if(a.length>0)for(var s=0;s<a.length;s++){var c=a[s];o[i]===c[i]&&a.splice(s,1)}function u(t){var e=null;return"parts"===t?(e="ProdNo",function(t,r){var n=t[e],o=r[e];return n-o}):(e="TastName",function(t,r){return t[e].localeCompare(r[e],"zh-CN")})}a=a.sort(u(e)),t.currentIndexFlavor=n,t[r]=a}e.default=h}).call(this,r("543d")["default"])},ad5a:function(t,e,r){"use strict";var n,o=function(){var t=this,e=t.$createElement,r=(t._self._c,t.setDecimalFun(t.SalePrice));t.$mp.data=Object.assign({},{$root:{m0:r}})},a=[];r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return a})),r.d(e,"a",(function(){return n}))},d8da:function(t,e,r){"use strict";r.r(e);var n=r("a9d3"),o=r.n(n);for(var a in n)"default"!==a&&function(t){r.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/stepperCard/index-create-component',
    {
        'components/stepperCard/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("32e4"))
        })
    },
    [['components/stepperCard/index-create-component']]
]);
