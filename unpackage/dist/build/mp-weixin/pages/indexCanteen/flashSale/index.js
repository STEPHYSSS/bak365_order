(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/indexCanteen/flashSale/index"],{"0496":function(t,e,n){"use strict";n.r(e);var o=n("1085"),i=n("09fa");for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("50c8");var r,c=n("f0c5"),s=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"00e2c998",null,!1,o["a"],r);e["default"]=s.exports},"09fa":function(t,e,n){"use strict";n.r(e);var o=n("edde"),i=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=i.a},1085:function(t,e,n){"use strict";var o,i=function(){var t=this,e=t.$createElement;t._self._c},a=[];n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o}))},"3cf1":function(t,e,n){"use strict";var o,i=function(){var t=this,e=t.$createElement,n=(t._self._c,t.setDecimalFun(t.goodInfo.ActiveSalePrice)),o=t.setDecimalFun(t.goodInfo.SalePrice),i=Number(t.activeInfo.ActiveStock),a=Number(t.activeInfo.ActiveSaleCount),r=t.setActiveStatus(),c=t.__map(t.activeInfo.SaleInfo,(function(e,n){var o=t.setName(e.Name);return{$orig:t.__get_orig(e),m5:o}}));t.$mp.data=Object.assign({},{$root:{m0:n,m1:o,m2:i,m3:a,m4:r,l0:c}})},a=[];n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o}))},"50c8":function(t,e,n){"use strict";var o=n("8b13"),i=n.n(o);i.a},8279:function(t,e,n){"use strict";n.r(e);var o=n("3cf1"),i=n("f5ca");for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("ce92");var r,c=n("f0c5"),s=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);e["default"]=s.exports},"8b13":function(t,e,n){},b726:function(t,e,n){"use strict";(function(t){n("b895");o(n("66fd"));var e=o(n("8279"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},ce92:function(t,e,n){"use strict";var o=n("cf3b"),i=n.n(o);i.a},cf3b:function(t,e,n){},e4da:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n("3955")),i=a(n("0496"));function a(t){return t&&t.__esModule?t:{default:t}}var r=n("bf5e"),c=function(){Promise.all([n.e("common/vendor"),n.e("components/stepperCard/index")]).then(function(){return resolve(n("32e4"))}.bind(null,n)).catch(n.oe)},s=function(){n.e("components/bottomSubmit/index").then(function(){return resolve(n("d78a"))}.bind(null,n)).catch(n.oe)},u=function(){n.e("components/customerService/index").then(function(){return resolve(n("9797"))}.bind(null,n)).catch(n.oe)},d=function(){Promise.all([n.e("common/vendor"),n.e("components_uni/gaoyia-parse/parse")]).then(function(){return resolve(n("ec1a"))}.bind(null,n)).catch(n.oe)},l=function(){n.e("components_uni/uni-countdown/uni-countdown").then(function(){return resolve(n("84ca"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("components_uni/wuc-tab/wuc-tab").then(function(){return resolve(n("16e0"))}.bind(null,n)).catch(n.oe)},f=function(){n.e("components/poppupChangeOrder/index").then(function(){return resolve(n("cf70"))}.bind(null,n)).catch(n.oe)},g=getApp(),m={components:{stepperCard:c,bottomSubmit:s,uParse:d,btnService:u,uniCountdown:l,WucTab:h,changeStore:i.default,changeStorePack:f},data:function(){return{keyImage:0,imgUrls:[],autoplay:!0,interval:3e3,duration:800,goodInfo:{},article:"",cartLists:[],imageSize:[],addNum:0,allMoney:0,ActiveID:"",windowWidth:0,provider:"",activeInfo:{},loading:!0,activeTimeMy:{},stateTime:!1,activeTimeEnd:"",itemColor:g.globalData.itemColor,colorIndex:g.globalData.colorIndex,isPack:g.globalData.isPack,TabCur:0,tabList:[{name:"商品详情"},{name:"最近成交"}],changeStoreShow:!1,clickStoreShow:!0,isNewStore:!1,currentStore:{},modeChange:{},clickShow:!1}},onShareAppMessage:function(){return{title:this.goodInfo.ProdName,path:"pages/indexCanteen/goodInfo/index?ProdNo="+this.goodInfo.ProdNo}},created:function(){},methods:{setDecimalFun:function(t){return r.setDecimal(t)},setName:function(t){return String(t).slice(0,1)+"**"},getShopInfo:function(){var e=this,n=t.getStorageSync("location");this.location=n,o.default.api("ShopInfo.aspx",{SearchVal:"",Longitude:n.longitude||"",Latitude:n.latitude||"",ActiveID:this.ActiveID||""}).then((function(t){e.dataList=t.ShopInfo,e.currentStore=e.dataList.filter((function(t){return t.ShopNo==g.globalData.shopNo})),e.$nextTick((function(){this.currentStore=this.currentStore[0]})),e.modeChange={LogisticsDistribution:t.WX_LogisticsDistribution,OrderEatInStore:t.WX_OrderEatInStore,OrderEatPackAway:t.WX_OrderEatPackAway},e.clickShow=!0})).catch((function(t){}))},getInfo:function(){var e=this;this.loading=!0,this.$showLoads(0,""),this.provider=g.globalData.provider;var n=this;o.default.api("Active/Seckill/Index.aspx",{ActiveID:this.ActiveID||""}).then((function(o){if(e.$showLoads(1,""),e.goodInfo=o.ProdInfo,e.activeInfo=o,e.goodInfo.ActiveID=e.ActiveID,e.goodInfo.StockQty=e.activeInfo.ActiveStock,e.goodInfo.EveryOneMaxBuyCount=e.activeInfo.EveryOneMaxBuyCount,e.goodInfo.ActiveOwnBuyCount=e.activeInfo.ActiveOwnBuyCount,e.activeInfo.hasOwnProperty("ShopInfo")){var i=e.activeInfo.ShopInfo.split(",");e.isNewStore=i.filter((function(t){return Number(t)===Number(g.globalData.shopNo)})).length>0}g.globalData.shopNo&&e.isNewStore&&g.globalData.isPack||t.setStorageSync("cartList",[]),e.tabList[1].name="最近成交("+e.activeInfo.SaleInfo.length+")",setTimeout((function(){e.article=e.activeInfo.ProdInfo.FeaturesHtmlInfo}),300),e.getTimeout();var a=t.getStorageSync("cartList"),r=0,c=0;if(a&&a.length>0)for(var s=a.slice(),u=0;u<s.length;u++){var d=s[u];n.ActiveID===d.ActiveID&&(n.goodInfo.num=d.num,d.hasOwnProperty("showStepper")&&(n.goodInfo.showStepper=d.showStepper)),r+=Number(d.num)*Number(d.SalePrice),c+=Number(d.num),0===Number(d.num)&&a.splice(u,1)}r=parseFloat(Math.round(100*r)/100),n.cartLists=a,n.allMoney=r,n.addNum=c,e.loading=!1})).catch((function(t){e.$showLoads(1,"")}))},setActiveStatus:function(t){if(t=t||"",this.activeTimeEnd)return"活动已结束";switch(this.activeInfo.ActiveStatus){case"0":return this.stateTime?"预计 "+this.activeInfo.EndTime+" 结束":"预计 "+this.activeInfo.StartTime+" 开始";case"1":return"已达到最大购买量";case"3":return"有代付款订单,请先付款";case"2":return this.stateTime?"预计 "+this.activeInfo.EndTime+" 结束":"预计 "+this.activeInfo.StartTime+" 开始";case"4":return"活动已结束"}},getTimeout:function(t){var e=(new Date).getTime(),n=new Date(this.activeInfo.EndTime.replace(/-/g,"/")).getTime(),o=new Date(this.activeInfo.StartTime.replace(/-/g,"/")).getTime();this.stateTime=!(o-e>=0);var i=this.stateTime?n-e:o-e,a=i;this.activeTimeMy={day:parseInt(a/864e5),hours:parseInt(a%864e5/36e5),minute:parseInt(a%36e5/6e4),second:parseInt(a%6e4/1e3)},this.activeTimeEnd=i<=0},timeupFun:function(){var t=this;setTimeout((function(){t.getTimeout()}),1e3)},onClickOrder:function(){t.navigateTo({url:"/pages/indexOrder/orderInfo/index?ActiveOrderID="+this.activeInfo.ActiveOrderID+"&id="+this.activeInfo.ActiveOrderID})},mycurrentPage:function(t){var e=this,n=r.setCard(t);this.allMoney=0,this.addNum=0;for(var o=0;o<n.length;o++){var i=n[o];this.allMoney+=Number(i.num)*Number(i.SalePrice),this.addNum+=Number(i.num)}this.allMoney=parseFloat(Math.round(100*this.allMoney)/100),this.cartLists=n,this.addNum=n.length>0?this.addNum:0,this.allMoney=n.length>0?this.allMoney:0,this.cartLists.length>0&&this.cartLists.forEach((function(t){t.ProdNo==e.goodInfo.ProdNo&&0==t.num&&(e.goodInfo.showStepper=!1)}))},clickStore:function(){this.isPack=g.globalData.isPack,this.cartLists=[],this.changeStoreShow=!1,this.isNewStore=!0,this.allMoney=0,this.$refs.stepperCard.clickTag()},clickStorePopup:function(){!this.isNewStore||this.isPack?this.changeStoreShow=!0:this.getShopInfo()},setShowStepper:function(t){this.goodInfo.showStepper=t},changeModeFun:function(t){this.isPack=t,this.clickShow=!1},setCartList:function(e,n){this.cartLists[n].num=e,this.cartLists[n].prodPartsInfo.forEach((function(t){t.num=e})),r.controlPartsStock(this,n);var o=this,i=JSON.parse(JSON.stringify(this.cartLists));o.allMoney=0,o.addNum=0;for(var a=0;a<i.length;a++){var c=i[a];Number(c.ProdNo)===Number(o.goodInfo.ProdNo)&&(o.goodInfo.num=c.num),o.allMoney+=Number(c.num)*Number(c.SalePrice),o.addNum+=Number(c.num)}for(var s=0;s<i.length;s++){var u=i[s];Number(0===u.num)&&i.splice(s,1)}this.$nextTick((function(){o.allMoney=parseFloat(Math.round(100*o.allMoney)/100),o.cartLists=i,o.addNum=i.length>0?o.addNum:0,o.allMoney=i.length>0?o.allMoney:0})),t.setStorage({key:"cartList",data:i})},clickClear:function(){this.goodInfo.num=0,this.cartLists=[],this.addNum=0,this.allMoney=0,t.setStorage({key:"cartList",data:[]})},determine:function(){t.navigateTo({url:"../paymentOrder/index"})},swiperImageLoad:function(t,e){++this.keyImage},onClose:function(t){t||(this.clickShow=!1)}},onLoad:function(e){var n=this;this.ActiveID=e.ActiveID||"SD00006",t.setStorageSync("ActiveID",this.ActiveID);var o=t.getSystemInfoSync(),i=o.windowWidth;o.windowHeight;this.windowWidth=i,g.globalData.openID?this.getInfo():this.$store.dispatch("Login").then((function(t){n.getInfo()}))},onShow:function(){t.getStorageSync("cartList")&&0!==t.getStorageSync("cartList").length||(this.cartLists=[],this.allMoney=0,this.goodInfo.num=0)}};e.default=m}).call(this,n("543d")["default"])},edde:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n("3955")),i=n("bf5e");function a(t){return t&&t.__esModule?t:{default:t}}var r=function(){n.e("components/nodeData/index").then(function(){return resolve(n("7f34"))}.bind(null,n)).catch(n.oe)},c=function(){n.e("components/poppupChangeOrder/index").then(function(){return resolve(n("cf70"))}.bind(null,n)).catch(n.oe)},s=getApp(),u={props:{isFlashSale:[Boolean,String,Number],ActiveID:[String,Number]},components:{nodeData:r,changeStore:c},data:function(){return{searchValue:"",location:"",dataList:[],clickShow:!1,radio:"1",currentItem:{},itemColor:s.globalData.itemColor,isCardPay:!1,indexCan:!1,isNearby:!1,isHome:!1,isGoodInfo:!1,modeChange:{},modeChangeNum:{}}},methods:{getList:function(){var e=this;this.$showLoads(0);var n=t.getStorageSync("location");this.location=n,o.default.api("ShopInfo.aspx",{SearchVal:this.searchValue,Longitude:n.longitude,Latitude:n.latitude,ActiveID:this.ActiveID||""}).then((function(n){e.dataList=n.ShopInfo,e.modeChange={LogisticsDistribution:n.WX_LogisticsDistribution,OrderEatInStore:n.WX_OrderEatInStore,OrderEatPackAway:n.WX_OrderEatPackAway},(e.isCardPay||e.isFlashSale)&&setTimeout((function(){t.showToast({title:"请选择门店",icon:"none"})})),e.$showLoads(1)})).catch((function(t){}))},clickSearch:function(){this.searchValue&&this.getList()},bindKeyInput:function(t){this.searchValue=t.detail.value,t.detail.value||this.getList()},clickStore:function(e){if(this.indexCan&&(s.globalData.shopNo=e.ShopNo,t.setStorageSync("cartList",[]),t.switchTab({url:"/pages/indexCanteen/index"})),this.isCardPay)return s.globalData.shopNo=e.ShopNo,void t.redirectTo({url:"/pages/indexVip/cardCharge/index"});if(this.isNearby){s.globalData.shopNo=e.ShopNo;JSON.stringify(e);return t.setStorageSync("cartList",[]),void t.redirectTo({url:"/pages/indexMain/index?currentShop="+JSON.stringify(e)})}if(this.isFlashSale&&s.globalData.isPack)return s.globalData.shopNo=e.ShopNo,t.setStorageSync("cartList",[]),void this.$emit("clickStore");var n=this.modeChange.LogisticsDistribution,o=this.modeChange.OrderEatInStore,a=this.modeChange.OrderEatPackAway,r=(0,i.setModeIf)(n,o,a);t.setStorageSync("cartList",[]),r.bool?(this.clickShow=!0,this.currentItem=e):(s.globalData.shopNo=e.ShopNo,s.globalData.isPack=r.currentMode,this.isFlashSale?this.$emit("clickStore"):this.isHome?t.redirectTo({url:"/pages/indexHomePage/index"}):this.isGoodInfo?t.redirectTo({url:"/pages/indexCanteen/goodInfo/index?ProdNo="+this.isGoodInfo}):t.switchTab({url:"/pages/indexCanteen/index"}))},onClose:function(t){t||(this.clickShow=!1)},changeMode:function(e){s.globalData.shopNo=this.currentItem.ShopNo,this.clickShow=!1,this.isFlashSale?this.$emit("clickStore"):this.isHome?t.redirectTo({url:"/pages/indexHomePage/index"}):this.isGoodInfo?t.redirectTo({url:"/pages/indexCanteen/goodInfo/index?ProdNo="+this.isGoodInfo}):t.switchTab({url:"/pages/indexCanteen/index"})}},onLoad:function(t){this.isNearby=t.isNearby||!1,this.isCardPay=t.isCardPay||!1,this.indexCan=t.indexCan||!1,this.isHome=t.homePage||!1,this.isGoodInfo=t.goodInfo||!1},created:function(){var t=this;s.globalData.openID?this.getList():this.$store.dispatch("Login").then((function(e){t.getList()}))},onShow:function(){}};e.default=u}).call(this,n("543d")["default"])},f5ca:function(t,e,n){"use strict";n.r(e);var o=n("e4da"),i=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=i.a}},[["b726","common/runtime","common/vendor"]]]);