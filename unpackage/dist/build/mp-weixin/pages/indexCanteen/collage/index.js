(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/indexCanteen/collage/index"],{"0496":function(e,t,n){"use strict";n.r(t);var o=n("7904"),i=n("09fa");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("3405");var r,c=n("f0c5"),s=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"2a904a52",null,!1,o["a"],r);t["default"]=s.exports},"09fa":function(e,t,n){"use strict";n.r(t);var o=n("edde"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},"2bfe":function(e,t,n){"use strict";(function(e){n("b895");o(n("66fd"));var t=o(n("3299"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},3299:function(e,t,n){"use strict";n.r(t);var o=n("8f5b"),i=n("3675");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("3af2");var r,c=n("f0c5"),s=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);t["default"]=s.exports},3405:function(e,t,n){"use strict";var o=n("42f7"),i=n.n(o);i.a},3675:function(e,t,n){"use strict";n.r(t);var o=n("51b6"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},"3af2":function(e,t,n){"use strict";var o=n("ee78"),i=n.n(o);i.a},"42f7":function(e,t,n){},"51b6":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("3955")),i=a(n("0496"));function a(e){return e&&e.__esModule?e:{default:e}}var r=n("bf5e"),c=function(){Promise.all([n.e("common/vendor"),n.e("components/stepperCard/index")]).then(function(){return resolve(n("32e4"))}.bind(null,n)).catch(n.oe)},s=function(){n.e("components/bottomSubmit/index").then(function(){return resolve(n("d78a"))}.bind(null,n)).catch(n.oe)},u=function(){n.e("components/customerService/index").then(function(){return resolve(n("9797"))}.bind(null,n)).catch(n.oe)},l=function(){Promise.all([n.e("common/vendor"),n.e("components_uni/gaoyia-parse/parse")]).then(function(){return resolve(n("ec1a"))}.bind(null,n)).catch(n.oe)},d=function(){n.e("components_uni/uni-countdown/uni-countdown").then(function(){return resolve(n("84ca"))}.bind(null,n)).catch(n.oe)},f=function(){n.e("components_uni/wuc-tab/wuc-tab").then(function(){return resolve(n("16e0"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("components/poppupChangeOrder/index").then(function(){return resolve(n("cf70"))}.bind(null,n)).catch(n.oe)},g=function(){Promise.all([n.e("common/vendor"),n.e("components_uni/uni-icons/uni-icons")]).then(function(){return resolve(n("a398"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("components_uni/uni-goods-nav/uni-goods-nav").then(function(){return resolve(n("15cf"))}.bind(null,n)).catch(n.oe)},p=getApp(),v={components:{stepperCard:c,bottomSubmit:s,uParse:l,btnService:u,uniCountdown:d,WucTab:f,changeStore:i.default,changeStorePack:h,uniIcons:g,uniGoodsNav:m},data:function(){return{keyImage:0,imgUrls:[],autoplay:!0,interval:3e3,duration:800,goodInfo:{},article:"",cartLists:[],imageSize:[],addNum:0,allMoney:0,ActiveID:"",windowWidth:0,provider:"",activeInfo:{},loading:!0,activeTimeMy:{},stateTime:!1,activeTimeEnd:"",itemColor:p.globalData.itemColor,colorIndex:p.globalData.colorIndex,isPack:p.globalData.isPack,TabCur:0,tabList:[{name:"商品详情"},{name:"最近成交"}],changeStoreShow:!1,clickStoreShow:!0,isNewStore:!1,currentStore:{},modeChange:{},clickShow:!1,GroupInfo:[],buttonGroup:[{text:"单独购买",backgroundColor:"#fe8953",color:"#fff"},{text:"我要开团",backgroundColor:"#ff4343",color:"#fff"}]}},created:function(){},methods:{setDecimalFun:function(e){return r.setDecimal(e)},setName:function(e){return String(e).slice(0,1)+"**"},getShopInfo:function(){var t=this,n=e.getStorageSync("location");this.location=n,o.default.api("ShopInfo.aspx",{SearchVal:"",Longitude:n.longitude||"",Latitude:n.latitude||"",ActiveID:this.ActiveID||""}).then((function(e){t.dataList=e.ShopInfo,t.currentStore=t.dataList.filter((function(e){return e.ShopNo==p.globalData.shopNo})),t.$nextTick((function(){this.currentStore=this.currentStore[0]})),t.modeChange={LogisticsDistribution:e.WX_LogisticsDistribution,OrderEatInStore:e.WX_OrderEatInStore,OrderEatPackAway:e.WX_OrderEatPackAway},t.clickShow=!0})).catch((function(e){}))},getInfo:function(){var t=this;this.loading=!0,this.$showLoads(0,""),this.provider=p.globalData.provider;var n=this;o.default.api("Active/GroupBuy/Index.aspx",{ActiveID:this.ActiveID||""}).then((function(o){if(t.$showLoads(1,""),t.goodInfo=o.ProdInfo,t.activeInfo=o,t.goodInfo.num=1,t.goodInfo.ActiveID=t.ActiveID,t.goodInfo.StockQty=t.activeInfo.ActiveStock,t.goodInfo.EveryOneMaxBuyCount=t.activeInfo.EveryOneMaxBuyCount,t.goodInfo.ActiveOwnBuyCount=t.activeInfo.ActiveOwnBuyCount,t.activeInfo.GroupInfo.length>0&&t.activeInfo.GroupInfo.forEach((function(e){e.VaildTime&&(e.activeTimeMy=t.getVaildTime(e.VaildTime))})),t.activeInfo.GroupInfo.length>3?t.GroupInfo=t.activeInfo.GroupInfo.slice(0,3):t.GroupInfo=t.activeInfo.GroupInfo,t.activeInfo.hasOwnProperty("ShopInfo")){var i=t.activeInfo.ShopInfo.split(",");t.isNewStore=i.filter((function(e){return Number(e)===Number(p.globalData.shopNo)})).length>0}p.globalData.shopNo&&t.isNewStore&&p.globalData.isPack||e.setStorageSync("cartList",[]),t.tabList[1].name="最近成交("+t.activeInfo.SaleInfo.length+")",setTimeout((function(){t.article=t.activeInfo.ProdInfo.FeaturesHtmlInfo}),300),t.getTimeout();var a=e.getStorageSync("cartList"),r=0,c=0;if(a&&a.length>0)for(var s=a.slice(),u=0;u<s.length;u++){var l=s[u];n.ActiveID===l.ActiveID&&(n.goodInfo.num=l.num,l.hasOwnProperty("showStepper")&&(n.goodInfo.showStepper=l.showStepper)),r+=Number(l.num)*Number(l.SalePrice),c+=Number(l.num),0===Number(l.num)&&a.splice(u,1)}r=parseFloat(Math.round(100*r)/100),n.cartLists=a,n.allMoney=r,n.addNum=c,t.loading=!1,e.stopPullDownRefresh(),e.hideNavigationBarLoading(),e.showShareMenu({withShareTicket:!0,title:t.goodInfo.ProdName,path:"/pages/indexCanteen/goodInfo/index?ProdNo="+t.goodInfo.ProdNo})})).catch((function(n){t.$showLoads(1,""),e.stopPullDownRefresh(),e.hideNavigationBarLoading()}))},setActiveStatus:function(e){if(e=e||"",this.activeTimeEnd)return"拼团已结束";switch(this.activeInfo.ActiveStatus){case"0":return this.stateTime?"预计 "+this.activeInfo.EndTime+" 结束":"预计 "+this.activeInfo.StartTime+" 开始";case"1":return"已达到最大购买量";case"3":return"有代付款订单,请先付款";case"2":return this.stateTime?"预计 "+this.activeInfo.EndTime+" 结束":"预计 "+this.activeInfo.StartTime+" 开始";case"4":return"拼团已结束"}},getTimeout:function(e){var t=(new Date).getTime(),n=new Date(this.activeInfo.EndTime.replace(/-/g,"/")).getTime(),o=new Date(this.activeInfo.StartTime.replace(/-/g,"/")).getTime();this.stateTime=!(o-t>=0);var i=this.stateTime?n-t:o-t,a=i;this.activeTimeMy={day:parseInt(a/864e5),hours:parseInt(a%864e5/36e5),minute:parseInt(a%36e5/6e4),second:parseInt(a%6e4/1e3)},this.activeTimeEnd=i<=0},getVaildTime:function(e){var t=(new Date).getTime(),n=new Date(e.replace(/-/g,"/")).getTime(),o=n-t;return{day:parseInt(o/864e5),hours:parseInt(o%864e5/36e5),minute:parseInt(o%36e5/6e4),second:parseInt(o%6e4/1e3)}},timeupFun:function(){var e=this;setTimeout((function(){e.getTimeout()}),1e3)},onClickOrder:function(){e.navigateTo({url:"/pages/indexOrder/orderInfo/index?&id="+this.activeInfo.ActiveOrderID})},mycurrentPage:function(t,n,i){n?(t.itemData.hasOwnProperty("ActiveID")&&delete t.itemData.ActiveID,e.setStorageSync("listCollage",[t.itemData]),e.navigateTo({url:"../paymentOrder/index?isCollage=true"})):(t.itemData.hasOwnProperty("ActiveID")||(t.itemData.ActiveID=this.ActiveID),"{}"!==JSON.stringify(i)&&(e.showLoading({title:""}),o.default.api("Active/Submit_ajax.aspx",{ActiveID:this.ActiveID||"",Type:"AddGroupBuy",GroupNo:"",HeardImg:i.HeardImg,NickName:i.NickName}).then((function(n){e.hideLoading(),e.setStorageSync("listCollage",[t.itemData]),e.navigateTo({url:"../paymentOrder/index?isCollage=true"})})).catch((function(t){e.showToast({title:t||"参团失败！",duration:2e3,icon:"none"})}))))},clickStore:function(){this.isPack=p.globalData.isPack,this.cartLists=[],this.changeStoreShow=!1,this.isNewStore=!0,this.allMoney=0},clickStorePopup:function(){!this.isNewStore||this.isPack?this.changeStoreShow=!0:this.getShopInfo()},setShowStepper:function(e){this.goodInfo.showStepper=e},changeModeFun:function(e){this.isPack=e,this.clickShow=!1},swiperImageLoad:function(e,t){++this.keyImage},onClose:function(e){e||(this.clickShow=!1)},groupPlaying:function(){e.navigateTo({url:"/pages/indexCanteen/collage/explain"})},getTogether:function(t){e.navigateTo({url:"/pages/indexCanteen/collage/info?ActiveID="+this.ActiveID+"&GroupNo="+t})},collageList:function(t){var n=t?"/pages/indexCanteen/collage/collageList?myCollage=true&ActiveID="+this.ActiveID:"/pages/indexCanteen/collage/collageList?ActiveID="+this.ActiveID;e.navigateTo({url:n})}},onPullDownRefresh:function(){e.showNavigationBarLoading(),this.getInfo()},onLoad:function(t){var n=this;this.ActiveID=t.ActiveID||"";var o=e.getSystemInfoSync(),i=o.windowWidth;o.windowHeight;this.windowWidth=i,p.globalData.openID?this.getInfo():this.$store.dispatch("Login").then((function(e){n.getInfo()}))},onShow:function(){e.getStorageSync("cartList")&&0!==e.getStorageSync("cartList").length||(this.cartLists=[],this.allMoney=0,this.goodInfo.num=1)}};t.default=v}).call(this,n("543d")["default"])},7904:function(e,t,n){"use strict";var o,i=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},"8f5b":function(e,t,n){"use strict";var o={uParse:function(){return Promise.all([n.e("common/vendor"),n.e("components/u-parse/u-parse")]).then(n.bind(null,"b859"))}},i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.setDecimalFun(e.goodInfo.ActiveSalePrice)),o=e.setDecimalFun(e.goodInfo.SalePrice),i=Number(e.activeInfo.ActiveStock),a=Number(e.activeInfo.ActiveSaleCount),r=e.setActiveStatus(),c=e.__map(e.activeInfo.SaleInfo,(function(t,n){var o=e.setName(t.Name);return{$orig:e.__get_orig(t),m5:o}}));e.$mp.data=Object.assign({},{$root:{m0:n,m1:o,m2:i,m3:a,m4:r,l0:c}})},a=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},edde:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("3955")),i=n("bf5e");function a(e){return e&&e.__esModule?e:{default:e}}var r=function(){n.e("components/nodeData/index").then(function(){return resolve(n("7f34"))}.bind(null,n)).catch(n.oe)},c=function(){n.e("components/poppupChangeOrder/index").then(function(){return resolve(n("cf70"))}.bind(null,n)).catch(n.oe)},s=getApp(),u={props:{isFlashSale:[Boolean,String,Number],ActiveID:[String,Number]},components:{nodeData:r,changeStore:c},data:function(){return{searchValue:"",location:"",dataList:[],clickShow:!1,radio:"1",currentItem:{},itemColor:s.globalData.itemColor,isCardPay:!1,indexCan:!1,isNearby:!1,isHome:!1,isGoodInfo:!1,modeChange:{},modeChangeNum:{}}},onLoad:function(e){this.isNearby=e.isNearby||!1,this.isCardPay=e.isCardPay||!1,this.indexCan=e.indexCan||!1,this.isHome=e.homePage||!1,this.isGoodInfo=e.goodInfo||!1},created:function(){var e=this;s.globalData.openID?this.getList():this.$store.dispatch("Login").then((function(t){e.getList()}))},methods:{getList:function(){var t=this;this.$showLoads(0);var n=e.getStorageSync("location");this.location=n,o.default.api("ShopInfo.aspx",{SearchVal:this.searchValue,Longitude:n.longitude,Latitude:n.latitude,ActiveID:this.ActiveID||""}).then((function(n){t.dataList=n.ShopInfo,t.modeChange={LogisticsDistribution:n.WX_LogisticsDistribution,OrderEatInStore:n.WX_OrderEatInStore,OrderEatPackAway:n.WX_OrderEatPackAway},(t.isCardPay||t.isFlashSale)&&setTimeout((function(){e.showToast({title:"请选择门店",icon:"none"})})),t.$showLoads(1)})).catch((function(e){}))},clickSearch:function(){this.searchValue&&this.getList()},bindKeyInput:function(e){this.searchValue=e.detail.value,e.detail.value||this.getList()},clickStore:function(t){if(this.indexCan&&(s.globalData.shopNo=t.ShopNo,e.setStorageSync("cartList",[]),e.switchTab({url:"/pages/indexCanteen/index"})),this.isCardPay)return s.globalData.shopNo=t.ShopNo,void e.redirectTo({url:"/pages/indexVip/cardCharge/index"});if(this.isNearby){s.globalData.shopNo=t.ShopNo;JSON.stringify(t);return e.setStorageSync("cartList",[]),void e.redirectTo({url:"/pages/indexMain/index?currentShop="+JSON.stringify(t)})}if(this.isFlashSale&&s.globalData.isPack)return s.globalData.shopNo=t.ShopNo,e.setStorageSync("cartList",[]),void this.$emit("clickStore");var n=this.modeChange.LogisticsDistribution,o=this.modeChange.OrderEatInStore,a=this.modeChange.OrderEatPackAway,r=(0,i.setModeIf)(n,o,a);e.setStorageSync("cartList",[]),r.bool?(this.clickShow=!0,this.currentItem=t):(s.globalData.shopNo=t.ShopNo,s.globalData.isPack=r.currentMode,this.isFlashSale?this.$emit("clickStore"):this.isHome?e.redirectTo({url:"/pages/indexHomePage/index"}):this.isGoodInfo?e.redirectTo({url:"/pages/indexCanteen/goodInfo/index?ProdNo="+this.isGoodInfo}):e.switchTab({url:"/pages/indexCanteen/index"}))},onClose:function(e){e||(this.clickShow=!1)},changeMode:function(t){s.globalData.shopNo=this.currentItem.ShopNo,this.clickShow=!1,this.isFlashSale?this.$emit("clickStore"):this.isHome?e.redirectTo({url:"/pages/indexHomePage/index"}):this.isGoodInfo?e.redirectTo({url:"/pages/indexCanteen/goodInfo/index?ProdNo="+this.isGoodInfo}):e.switchTab({url:"/pages/indexCanteen/index"})}},onShow:function(){}};t.default=u}).call(this,n("543d")["default"])},ee78:function(e,t,n){}},[["2bfe","common/runtime","common/vendor"]]]);