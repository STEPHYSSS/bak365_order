(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/indexCanteen/goodInfo/index"],{"1bf8":function(t,e,n){"use strict";(function(t){n("b895");o(n("66fd"));var e=o(n("ecc5"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"378f":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n("3955"));function r(t){return t&&t.__esModule?t:{default:t}}var a=n("bf5e"),i=function(){Promise.all([n.e("common/vendor"),n.e("components/stepperCard/index")]).then(function(){return resolve(n("32e4"))}.bind(null,n)).catch(n.oe)},s=function(){n.e("components/bottomSubmit/index").then(function(){return resolve(n("d78a"))}.bind(null,n)).catch(n.oe)},u=function(){Promise.all([n.e("common/vendor"),n.e("components/u-parse/u-parse")]).then(function(){return resolve(n("b859"))}.bind(null,n)).catch(n.oe)},c=function(){n.e("components/customerService/index").then(function(){return resolve(n("9797"))}.bind(null,n)).catch(n.oe)},d=getApp(),l={components:{stepperCard:i,bottomSubmit:s,uParse:u,btnService:c},data:function(){return{keyImage:0,imgUrls:[],autoplay:!0,interval:3e3,duration:800,goodInfo:{},article:"",cartLists:[],imageSize:[],addNum:0,allMoney:0,ProdNo:"",windowWidth:0,provider:""}},onShareAppMessage:function(){return{title:this.goodInfo.ProdName,path:"pages/indexCanteen/goodInfo/index?ProdNo="+this.goodInfo.ProdNo}},methods:{setDecimalFun:function(t){return a.setDecimal(t)},getInfo:function(){var e=this;this.provider=d.globalData.provider;var n=this;o.default.api("ProdItem.aspx",{ProdNo:n.ProdNo}).then((function(o){e.goodInfo=o,e.article=o.FeaturesHtmlInfo;var r=e.article.split("<img"),a=r.map((function(t){return t.replace("../","https://we.bak365.net/SmallProgramSaleOrder/")})),i=a.map((function(t){return-1!==t.indexOf("src")?"<img"+t:t}));e.article=i.join("");var s=t.getStorageSync("cartList"),u=0,c=0;if(s&&s.length>0){r=s.slice();for(var d=0;d<r.length;d++){var l=r[d];n.goodInfo.ProdNo===l.ProdNo&&(n.goodInfo.num=l.num,l.hasOwnProperty("showStepper")&&(n.goodInfo.showStepper=l.showStepper)),u+=Number(l.num)*Number(l.SalePrice),c+=Number(l.num),0===Number(l.num)&&s.splice(d,1)}}u=parseFloat(u.toFixed(2)),n.cartLists=s,n.allMoney=u,n.addNum=c})).catch((function(t){}))},mycurrentPage:function(t){var e=this,n=a.setCard(t);this.allMoney=0,this.addNum=0;for(var o=0;o<n.length;o++){var r=n[o];this.allMoney+=Number(r.num)*Number(r.SalePrice),this.addNum+=Number(r.num)}this.allMoney=parseFloat(this.allMoney.toFixed(2)),this.cartLists=n,this.addNum=n.length>0?this.addNum:0,this.allMoney=n.length>0?this.allMoney:0,this.cartLists.length>0&&this.cartLists.forEach((function(t){t.ProdNo==e.goodInfo.ProdNo&&0==t.num&&(e.goodInfo.showStepper=!1)}))},setShowStepper:function(t){this.goodInfo.showStepper=t},setCartList:function(e,n){this.cartLists[n].num=e,this.cartLists[n].prodPartsInfo.forEach((function(t){t.num=e})),a.controlPartsStock(this,n);var o=this,r=this.cartLists;o.allMoney=0,o.addNum=0;for(var i=0;i<r.length;i++){var s=r[i];Number(s.ProdNo)===Number(o.goodInfo.ProdNo)&&(o.goodInfo.num=s.num),o.allMoney+=Number(s.num)*Number(s.SalePrice),o.addNum+=Number(s.num)}for(i=0;i<r.length;i++){var u=r[i];Number(0===u.num)&&r.splice(i,1)}this.$nextTick((function(){o.allMoney=parseFloat(o.allMoney.toFixed(2)),o.cartLists=r,o.addNum=r.length>0?o.addNum:0,o.allMoney=r.length>0?o.allMoney:0})),t.setStorage({key:"cartList",data:r})},clickClear:function(){this.goodInfo.num=0,this.cartLists=[],this.addNum=0,this.allMoney=0,t.setStorage({key:"cartList",data:[]})},determine:function(){t.navigateTo({url:"../paymentOrder/index"})},swiperImageLoad:function(t,e){++this.keyImage}},onLoad:function(e){var n=this;this.ProdNo=e.ProdNo,this.getInfo();var o=t.getSystemInfoSync(),r=o.windowWidth;o.windowHeight;this.windowWidth=r,d.globalData.shopNo&&d.globalData.isPack||(console.log("没有门店"),t.reLaunch({url:"/pages/indexCanteen/changeStore/index?goodInfo="+this.ProdNo})),d.globalData.openID?(console.log("获取数据"),this.getInfo()):this.$store.dispatch("Login").then((function(t){n.getInfo()}))},onShow:function(){t.getStorageSync("cartList")&&0!==t.getStorageSync("cartList").length||(this.cartLists=[],this.allMoney=0,this.goodInfo.num=0)}};e.default=l}).call(this,n("543d")["default"])},"9c26":function(t,e,n){"use strict";var o=n("d8d7"),r=n.n(o);r.a},d64c:function(t,e,n){"use strict";var o,r=function(){var t=this,e=t.$createElement,n=(t._self._c,t.setDecimalFun(t.goodInfo.SalePrice));t.$mp.data=Object.assign({},{$root:{m0:n}})},a=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o}))},d8d7:function(t,e,n){},ebe9:function(t,e,n){"use strict";n.r(e);var o=n("378f"),r=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=r.a},ecc5:function(t,e,n){"use strict";n.r(e);var o=n("d64c"),r=n("ebe9");for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n("9c26");var i,s=n("f0c5"),u=Object(s["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],i);e["default"]=u.exports}},[["1bf8","common/runtime","common/vendor"]]]);